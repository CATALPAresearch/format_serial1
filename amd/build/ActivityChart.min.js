define(["jquery"],function(a){var b="",c=["#004C97","#004C97","#004C97","#004C97","#004C97","#004C97","#004C97"],d={viewed:"betrachtet",updates:"bearbeitet",deleleted:"gelÃ¶scht",created:"erstellt"},e={mod_forum:"Forum",mod_glossary:"Glossar",mod_wiki:"Wiki",mod_assignment:"Aufgabe",mod_studentquiz:"StudentQuiz",mod_quiz:"Quiz"},f=Object.keys(e),g=document.getElementById("ladtopic-container-0").offsetWidth,h={top:15,right:0,bottom:20,left:10},i=function(a,i,j,k,l,m,n){l=l.filter(function(a){return a.utc>=n.start&&a.utc<n.end}),b=i.bubbleChart("#timeline-chart"),this.chart=function(){return b},l.forEach(function(a,b){a.date=new Date(1e3*a.utc),a.action_type=f.indexOf(a.action_type)});var o=j(l),p=o.dimension(function(a){return[a.date,a.action_type,a.action]}),q=p.group().reduce(function(a,b){return++a.count,a.date=b.date,a.action=b.action,a.action_type=b.action_type,a},function(a,b){return--a.count,a.date=b.date,a.action=b.action,a.action_type=b.action_type,a},function(){return{count:0,date:0,action:"",action_type:""}});this.getGroup=function(){return q};var r=[a.min(q.all(),function(a){return a.key[0]}),a.max(q.all(),function(a){return a.key[0]})];r[1]=k(r[1]).isSameOrBefore(new Date)?new Date:r[1],this.getXRange=function(){return r};for(var s=a.max(q.all(),function(a){return a.value.count}),t=a.scaleOrdinal().domain(f).range(c),u=[],v=0;v<l.length;v++)u.push(l[v].action_type);var w=u.filter(function(a,b,c){return c.indexOf(a)===b}).length;w=6,b.width(g).height(20*w).margins({top:10,bottom:20,left:h.left,right:h.right}).clipPadding(65).renderLabel(!1).minRadius(1).maxBubbleRelativeSize(.3).x(a.scaleTime().domain(r).range([0,g])).brushOn(!0).dimension(p).group(q).renderHorizontalGridLines(!0).keyAccessor(function(a){return a.value.date}).valueAccessor(function(a){return a.value.action_type}).radiusValueAccessor(function(a){return a.value.count/s}).colors(t).title(function(a){return["Am "+m.formatDate(a.value.date)," haben Sie "+m.numberToWord(a.value.count,"mal")," das "+e[f[a.value.action_type]]," "+d[a.value.action]].join("")}).xAxis(a.axisBottom().ticks(10)),this.update=function(c){b.x(a.scaleTime().domain(c)).selectAll("line.grid-line").attr("y2",b.effectiveHeight()).attr("opacity",.5),b.render()},b.selectAll(".axis.y .tick").attr("transform","translate(50,0)").style("transition-duration","0"),b.elasticY(!0).yAxisPadding(0).yAxis().ticks(w).tickFormat(function(a){if(a===Math.ceil(a))return e[f[a]]}),b.render(),b.on("pretransition",function(){b.selectAll("line.grid-line").attr("y2",b.effectiveHeight()).attr("opacity",.5)}),b.on("renderlet",function(b){var c=a.select("#timeline-chart svg");c.select("g.y").style("transition-duration","0").attr("transform","translate(35,10)"),c.selectAll("g.y g.tick text").attr("text-anchor","start").attr("class","timeline-y-label")})};return window.onresize=function(a){g=document.getElementById("planing-component").offsetWidth,i.chart.width(g).transitionDuration(0),i.chart.group(i.getGroup())},i});