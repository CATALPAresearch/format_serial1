require.config({enforceDefine:!1,baseUrl:M.cfg.wwwroot+"/course/format/ladtopics/lib/build/",paths:{d3v4:["d3.v4.min"]},shim:{}}),define(["jquery",M.cfg.wwwroot+"/course/format/ladtopics/lib/build/vue.min.js","d3v4",M.cfg.wwwroot+"/course/format/ladtopics/amd/src/Utils.js"],(function(n,t,e,o){return o=new o,t.component("dashboard-completion",{props:["course"],data:function(){return{sections:[],info:"",current:{id:0,section:0}}},mounted:function(){var n=this;o.get_ws("completionprogress",{courseid:parseInt(this.course.id,10)},(function(t){try{n.draw(JSON.parse(t.completions))}catch(t){console.error(t)}}))},methods:{draw:function(n){this.sections=function(n,t){var e=[];for(var o in n)e[n[o][t]]=e[n[o][t]]||[],e[n[o][t]].push(n[o]);return e.filter((function(n){return null!==n}))}(n,"section"),console.log(this.sections)},setCurrent:function(n,t){this.current={id:n,section:t}},getCurrent:function(){return this.sections[this.current.section][this.current.id]},getLink:function(n){return"/moodle/mod/"+(n=null==n?this.getCurrent():n).type+"/view.php?id="+n.id},getStatus:function(n){return 0===(n=null==n?this.getCurrent():n).completion?'<i class="fa fa-times-square"></i>Nicht abgeschlossen':'<i class="fa fa-check"></i> Abgeschlossen'}},template:'\n                <div id="dashboard-completion">\n                    <div id="completion-chart">\n                        <svg style="border: none;">\n                            <g transform="translate(0,10)" id="dashboard-completion">\n                                <g v-for="(section, sIndex) in sections">\n                                    <g :transform="\'translate(0,\' + (30*sIndex+14) +\')\'">\n                                        <text class="completion-section-name">{{ section[0].sectionname }}</text>\n                                    </g>\n                                    <g v-for="(m, index) in section" :transform="\'translate(70,\' + (1*sIndex) +\')\'">\n                                    <a\n                                        data-toggle="tooltip" \n                                        data-container="body" \n                                        :title="m.type" \n                                        data-content="m.name" \n                                        data-placement="top">\n                                            <rect @mouseover="setCurrent(index, sIndex)" class="completion-rect"\n                                                :x="index * 20" \n                                                :y="sIndex*30" \n                                                :height="20" \n                                                :width="20"\n                                                :fill="m.completion==1 ? \'green\' : \'blue\'"\n                                                data-toggle="popover" \n                                                data-container="body" \n                                                :title="m.type" \n                                                :data-content="m.name" \n                                                data-placement="bottom"\n                                                >\n                                        </a>\n                                        </g>\n                                    </rect>\n                                </g>\n                                <g transform="translate(20,100)" class="completion-info">\n                                    \n                                </g>\n                            </g>\n                        </svg>\n                        <div>\n                            <a v-bind:href="getLink()">\n                                <span v-if="getCurrent().completion === 0"><i class="fa fa-times-rectangle"></i> {{ getCurrent().name }}, nicht abgeschlossen</span>\n                                <span v-if="getCurrent().completion !== 0"><i class="fa fa-check"></i> {{ getCurrent().name }}, abgeschlossen</span>\n                            </a>\n                        </div>\n                    </div>\n                </div>'})}));