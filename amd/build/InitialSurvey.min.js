define(["jquery"],function(a){var b=function(b,c,d,e,f){var g=2,h=3,i=parseInt(a("#courseid").text(),10),j={};j.biwi={},j.biwi.exame=[],j.biwi.orientation=[],j.cs={},j.cs.exame=[],j.cs.orientation=[],new b({el:"#planningsurvey",data:function(){return{modalSurveyVisible:!1,surveyComplete:!1,objectives:"",availableTime:0,planingStyle:"",selectedMonth:0,selectedYear:0,resources:[],availableResources:[],invalidAvailableTime:!1,invalidAvailableTimeNotEnough:!1,invalidObjective:!1,invalidResources:!1,invalidPlaningStyle:!1}},mounted:function(){var b=this;e.get_ws("coursestructure",{courseid:parseInt(f.id,10),select:{modules:JSON.stringify(["assign","data","hvp","checklist","url","studentquiz","page","feedback","forum","resource","glossary","quiz","wiki"])}},function(a){try{var c=JSON.parse(a.data),d=new Array(c.length);for(var e in c){var f=0;for(var g in c)c[e]!==c[g]&&(+c[g].pos_section<+c[e].pos_section?f++:+c[g].pos_module<+c[e].pos_module&&f++);for(;"object"==typeof d[f];)f++;d[f]=c[e]}b.availableResources=d}catch(a){console.error(a)}}),e.get_ws("userpreferences",{data:{setget:"get",fieldname:"ladtopics_survey_done",courseid:parseInt(f.id,10)}},function(c){try{c=JSON.parse(c.response),c[0]&&parseInt(c[0].value,10)&&(b.surveyComplete=parseInt(c[0].value,10)>0,d.surveyDone=parseInt(c[0].value,10)),d.surveyDone>0?a("#planing-component").show():a("#planningsurvey").show()}catch(c){console.error("Could not fetch user_preferences: ",c)}})},created:function(){this.showModal()},methods:{showModal:function(a){this.modalSurveyVisible=!0},closeModal:function(a){this.modalSurveyVisible=!1},monthRange:function(){return e.monthRange},yearRange:function(){return[2020,2021,2022,2023]},monthSelected:function(a){this.selectedMonth=a.target.value},yearSelected:function(a){this.selectedYear=a.target.value},resourcesBySection:function(a){return this.availableResources.filter(function(b){return parseInt(b.section_id,10)===parseInt(a,10)})},resourceSections:function(){for(var a={},b=0;b<this.availableResources.length;b++)a[this.availableResources[b].section_id]={name:" "===this.availableResources[b].section_name?"(Einführung)":this.availableResources[b].section_name,id:this.availableResources[b].section_id};return a},resourceById:function(a){return this.availableResources.filter(function(b){return parseInt(b.id,10)===parseInt(a,10)})[0]},resourceSelected:function(a){var b=-1;b=a.target.value.match(/complete-section-\d/i)?-99:this.resourceById(a.target.value),this.resources.push(b);var d=document.getElementById("selected_resources");c.create(d,{});this.invalidResources=!(this.resources.length>0)},resourceRemove:function(a){for(var b=0;b<this.resources.length;b++)this.resources[b].id===a&&this.resources.splice(b,1);this.invalidResources=!(this.resources.length>0)},updateObjective:function(a){this.invalidObjective=""===this.objectives},updateAvailableTime:function(){this.invalidAvailableTime=this.availableTime<=0,this.invalidAvailableTimeNotEnough=this.availableTime<=f.minimumWeeklyWorkload},updatePlaningStyle:function(a){this.invalidPlaningStyle=""===this.planingStyle},validateSurveyForm:function(){var a=!0;""===this.objectives&&(this.invalidObjective=!0,a=!1),this.availableTime<=0&&(this.invalidAvailableTime=!0,a=!1),""===this.planingStyle&&(this.invalidPlaningStyle=!0,a=!1),"f1c"===this.objectives&&0===this.resources.length&&this.availableResources.length>0&&(this.invalidResources=!0,a=!1),a&&this.saveSurvey()},isAvailableTimeSufficient:function(){return this.availableTime<=0?"":"f1a"===this.objectives&&1===+this.availableTime?"Eine Stunde pro Woche ist zu wenig Zeit, um sich auf die Prüfung vorzubereiten. Der Arbeitsaufwand für ein Modul beträgt 19h pro Woche.":"f1a"===this.objectives&&this.availableTime>1&&this.availableTime<=f.minimumWeeklyWorkload?this.availableTime+" Stunden pro Woche sind zu wenig Zeit, um sich auf die Prüfung vorzubereiten. Der Arbeitsaufwand für ein Modul beträgt 19h pro Woche.":"f1a"!==this.objectives&&1===this.availableTime?"Eine Stunde pro Woche ist zu wenig Zeit, um das Modul in einem Semester durchzuarbeiten. Der Arbeitsaufwand für ein Modul beträgt 19h pro Woche.":"f1a"!==this.objectives&&this.availableTime>1&&this.availableTime<=f.minimumWeeklyWorkload?this.availableTime+" Stunden pro Woche sind zu wenig Zeit, um das Modul in einem Semester durchzuarbeiten. Der Arbeitsaufwand für ein Modul beträgt 19h pro Woche.":this.availableTime>=f.maximumWeeklyWorkload?"Wollen Sie wirklich "+this.availableTime+" Stunden pro Woche aufwenden? Normalerweise benötigt man ca. 20 h/Woche für eine gute Vorbereitung.":void 0},buttonText:function(){var a="Ohne Planung fortfahren",b={f1a:", damit ich mich gut auf die Prüfung vorbereiten kann.",f1b:", damit ich mich im Kurs orientieren kann.",f1c:".",f1d:"."},c={"planing-style-a":"im Wochentakt","planing-style-b":"im 4-Wochentakt","planing-style-c":"im Wochentakt","planing-style-d":"im 2-Wochentakt","planing-style-e":"im Monatstakt","planing-style-f":""};return""===this.objectives&&""===this.planingStyle||(a=["Semesterplanung ",void 0===c[this.planingStyle]?"":c[this.planingStyle]," vorschlagen",b[this.objectives]].join("")),a},saveSurvey:function(){switch(this.modalSurveyVisible=!1,this.objectives){case"f1a":i===g&&j.biwi.exame.length>0?d.addMilestones(j.biwi.exame):i===h&&j.cs.exame.length>0&&d.addMilestones(j.cs.exame);break;case"f1b":i===g&&j.biwi.orientation.length>0?d.addMilestones(j.biwi.orientation):i===h&&j.cs.orientation.length>0&&d.addMilestones(j.cs.orientation);break;case"f1c":break;case"f1d":}var b=this;e.get_ws("userpreferences",{data:{setget:"set",courseid:parseInt(f.id,10),fieldname:"ladtopics_survey_done",value:1}},function(c){try{c=JSON.parse(c.response),d.surveyDone=1,this.surveyComplete=!0,a("#theSurveyModal").modal("hide"),a("#planing-component").show(),a(".survey-btn").hide(),e.get_ws("userpreferences",{data:{setget:"set",courseid:parseInt(f.id,10),fieldname:"ladtopics_survey_results",value:JSON.stringify({objectives:b.objectives,availableTime:b.availableTime,planingStyle:b.planingStyle,selectedMonth:b.selectedMonth,selectedYear:b.selectedYear,resources:b.resources})}},function(a){})}catch(c){console.error("Could not fetch user_preferences: ",c)}})}}})};return b});