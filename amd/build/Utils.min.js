/**
 * Javascript utils for the Moodle videodatabase
 *
 * @module     mod_videodatabase/videodatabase
 * @package    mod_videodatabase
 * @class      Utils
 * @copyright  2019 Niels Seidel, niels.seidel@fernuni-hagen.de
 * @license    MIT
 * @since      3.1
 */
define(["jquery","core/ajax"],(function(e,t){return function(r,a){this.d3=a,this.dc=r,this.get_ws=function(r,a,n,i){i=void 0!==i&&i,t.call([{methodname:i?r:"format_ladtopics_"+r,args:a,done:function(t){t.hasOwnProperty("exception")?e("#alert").html("Die Prozedur "+r+" konnte nicht als Webservice geladen werden.<br>").append(JSON.stringify(t)):n(t)},fail:function(e){console.log(r),console.error(e)}}])},this.germanFormatters=a.timeFormatDefaultLocale({decimal:",",thousands:".",grouping:[3],currency:["€",""],dateTime:"%a %b %e %X %Y",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jän","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]}),this.customTimeFormat=function(e){return e.getMinutes()?a.timeFormat("%I:%M")(e):e.getMilliseconds()?a.timeFormat(".%L")(e):e.getSeconds()?a.timeFormat(":%S")(e):e.getHours()?a.timeFormat("%Hh")(e):e.getDay()?a.timeFormat("%a %e.%m.")(e):e.getMonth()?a.timeFormat("%B")(e):a.getDate("%Y")},this.monthRange=[{num:1,name:"Januar"},{num:2,name:"Feburar"},{num:3,name:"März"},{num:4,name:"April"},{num:5,name:"Mai"},{num:6,name:"Juni"},{num:7,name:"Juli"},{num:8,name:"August"},{num:9,name:"September"},{num:10,name:"Oktober"},{num:11,name:"November"},{num:12,name:"Dezember"}],this.numberToWord=function(e,t){switch(t=void 0===t?"":t,e){case 0:return"kein"+t;case 1:return"ein"+t;case 2:return"zwei"+t;case 3:return"drei"+t;case 4:return"vier"+t;case 5:return"fünf"+t;case 6:return"sechs"+t;case 7:return"sieben"+t;case 8:return"acht"+t;case 9:return"neun"+t;case 10:return"zehn"+t;case 11:return"elf"+t;default:return e+" "+t}};const n=a.timeFormatLocale({decimal:",",thousands:".",grouping:[3],currency:["€",""],dateTime:"%a %b %e %X %Y",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]});this.formatMillisecond=n.format(".%L"),this.formatSecond=n.format(":%S"),this.formatMinute=n.format("%I:%M"),this.formatHour=n.format("%H:%M"),this.formatDay=n.format("%a %e.%m."),this.formatDate=n.format("%d.%m.%Y"),this.formatDate2=n.format("%d/%m/%Y"),this.formatWeek=n.format("%b %d"),this.formatWeekNum=n.format("%U"),this.formatMonth=n.format("%B"),this.formatYear=n.format("%Y"),this.multiFormat=function(e){return a.timeSecond(e)<e?this.formatMillisecond:a.timeMinute(e)<e?this.formatSecond:a.timeHour(e)<e?this.formatMinute:a.timeDay(e)<e?this.formatHour:a.timeMonth(e)<e?a.timeWeek(e)<e?this.formatDay:this.formatWeek:a.timeYear(e)<e?this.formatMonth:this.formatYear},this.addFilterChart=function(e,t){var a=this.d3.scale.ordinal().domain([0]).range(["#e6550d"]),n=t.dimension((function(t){return t[e.indepVar]})),i=n.group().reduceSum((function(t){return+t[e.depVar]})),o=void 0===e.margins?{top:0,right:5,bottom:20,left:2}:e.margins,s=void 0===e.colors?a:e.colors,m="";switch(e.chartType){case"rowChart":(m=r.rowChart(e.selector)).xAxis().ticks(4),m.margins(o).height(130);break;case"pieChart":(m=r.pieChart(e.selector)).innerRadius(20).height(100)}m.dimension(n).group(i).colors(s).title((function(t){return[e.indepVar.charAt(0).toUpperCase(),e.indepVar.slice(1,e.indepVar.length),": ",t.key,"\n","Value: ",t.value].join("")})).label((function(t){return e.keys[t.key]||t.key})),this.register(m)},this.charts=[],this.register=function(e){this.charts.push(e)},this.resetCharts=function(){for(var e=0;e<this.charts.length;e++)this.charts[e].filterAll();r.redrawAll()},this.mergeObjects=function(e,t){var r={};for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);for(var a in t)t.hasOwnProperty(a)&&(r[a]=t[a]);return r}}}));