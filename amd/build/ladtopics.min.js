/**
 * Main method of the plugin. Load depending javascript and css before starting the timeline dashboard.
 *
 * @module     format/ladtopics
 * @class      LADTopics
 * @copyright  2019 Niels Seidel <niels.seidel@fernuni-hagen.de>
 * @license    MIT
 * @since      3.1
 */
define(["jquery",M.cfg.wwwroot+"/course/format/ladtopics/amd/src/Timeline.js",M.cfg.wwwroot+"/course/format/ladtopics/amd/src/Utils.js",M.cfg.wwwroot+"/course/format/ladtopics/amd/src/FilterChart.js",M.cfg.wwwroot+"/course/format/ladtopics/amd/src/ActivityChart.js",M.cfg.wwwroot+"/course/format/ladtopics/amd/src/InitialSurvey.js",M.cfg.wwwroot+"/course/format/ladtopics/amd/src/Logging.js",M.cfg.wwwroot+"/course/format/ladtopics/amd/src/ErrorHandler.js"],(function(o,r,e,t,i,s,c,n){require.config({enforceDefine:!1,paths:{d3:[M.cfg.wwwroot+"/course/format/ladtopics/lib/buil/d3.v4.min"],crossfilter:[M.cfg.wwwroot+"/course/format/ladtopics/lib/build/crossfilter.min"],dc:[M.cfg.wwwroot+"/course/format/ladtopics/lib/build/dc.v3.min"],moment226:[M.cfg.wwwroot+"/course/format/ladtopics/lib/build/moment-with-locales.min"],intro293:[M.cfg.wwwroot+"/course/format/ladtopics/lib/build/intro.min"],ICAL:[M.cfg.wwwroot+"/course/format/ladtopics/lib/build/ical.min"],vDP:[M.cfg.wwwroot+"/course/format/ladtopics/lib/build/vDP.min"],vDPde:[M.cfg.wwwroot+"/course/format/ladtopics/lib/build/vDPde.min"]},shim:{dc:{deps:["d3","crossfilter"]},moment226:{exports:"moment"},intro293:{export:"introJs"},crossfilter:{exports:"crossfilter"},ICAL:{exports:"ICAL"},vDP:{exports:"vDP"},vDPde:{exports:"vDPde"}}});let a=o("#region-main-box");const l=a.outerHeight();return a.change((function(){a.outerHeight()>l&&a.show()})),a.hide(),{init:function(a){require(["crossfilter","d3","dc","moment226","intro293","vDP","vDPde"],(function(l,f,d,u,w,m,g){n.logger=b,n.logWindowErrors(),n.logConsoleErrors();var p=new e,b=new c(a,{context:"format_ladtopics",outputType:1});p.get_ws("limesurvey",{courseid:parseInt(a,10)},(function(r){try{if("object"==typeof r&&null!==r&&"string"==typeof r.data){const e=JSON.parse(r.data);if(!0===e.warnSurvey){let r="Sie haben noch offene Umfragen zur Begleitforschung der Forschungsprojekte APLE / LA-DIVA.";if(e.warnDate){const o=u(1e3*e.warnDate),t=u(),i=""+o.diff(t,"days"),s=new Date(1e3*e.warnDate),c=("0"+s.getDate()).slice(-2),n=("0"+(s.getMonth()+1)).slice(-2),a=s.getFullYear(),l=s.getHours();r=`Sie haben noch ${i} Tage Zeit, um eine Umfrage zur Begleitforschung der Forschungsprojekte APLE / LA-DIVA aufzuschieben. <br />Ab dem ${c}.${n}.${a} ${l}:${s.getMinutes()} Uhr müssen Sie die Umfrage absolvieren, um wieder auf die Lernumgebung zurgreifen zu können.`}const t=window.location.href,i=t.substr(0,t.indexOf("view")),s=o(`\n                                            <div class="alert alert-primary" style="cursor:pointer;">\n                                                <div class="w-75">\n                                                    <p>${r}</p>\n                                                    <button type="button" class="btn btn-primary" onclick="javascript:window.location.href='${`${i}format/ladtopics/survey.php?c=${a}`}'">Zur Umfrageübersicht</button>\n                                                </div>                                                \n                                            </div>\n                                            `);o("header").after(s)}}}catch(o){new n(o)}})),new r(f,d,l,u,p,w,b,t,i,s,m,g,n)}))}}}));